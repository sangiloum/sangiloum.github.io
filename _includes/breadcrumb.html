{% assign segments = page.url | split: '/' %}
{% assign segment_count = 0 %}
{% for segment in segments %}
  {% if segment != '' and segment != 'index.html' %}
    {% assign segment_count = segment_count | plus: 1 %}
  {% endif %}
{% endfor %}

<nav class="breadcrumb" aria-label="Breadcrumb">
  <ol class="breadcrumb-list">
    <li class="breadcrumb-item">
      {% if page.url == '/' %}
      <span aria-current="page">Home</span>
      {% else %}
      <a href="{{ '/' | relative_url }}">Home</a>
      {% endif %}
    </li>
    {% if page.url != '/' %}
      {% if page.layout == 'year-archive' %}
      <li class="breadcrumb-item">
        <a href="{{ '/blog/' | relative_url }}">Blog</a>
      </li>
      {% endif %}
      {% assign current_path = '' %}
      {% assign seen_count = 0 %}
      {% for segment in segments %}
        {% if segment != '' and segment != 'index.html' %}
          {% assign current_path = current_path | append: '/' | append: segment %}
          {% assign seen_count = seen_count | plus: 1 %}
          {% assign label = segment | replace: '-', ' ' | capitalize %}
          <li class="breadcrumb-item">
            {% if seen_count == segment_count %}
              {% assign current_label = page.title | default: '' | strip %}
              {% if current_label == '' %}
                {% assign current_label = label %}
              {% endif %}
              <span aria-current="page">{{ current_label }}</span>
            {% else %}
              {% assign segment_href = current_path | append: '/' %}
              {% if segment_href == '/blog/category/' %}
                <span>{{ label }}</span>
              {% else %}
                <a href="{{ segment_href | relative_url }}">{{ label }}</a>
              {% endif %}
            {% endif %}
          </li>
        {% endif %}
      {% endfor %}
    {% endif %}
  </ol>
</nav>
